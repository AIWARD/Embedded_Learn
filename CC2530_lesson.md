# CC2530 寄存器初始化整理

```c
// 配置寄存器中第一位为1时  
// (0000 0000)|(0000 0001)= 0000 0001 
P1DIR |=  0x01 ;
// 配置寄存器中第二位为0时  ~(0000 0010) = (1111 1101)
// (1111 1111)&(1111 1101) = 1111 1101
P1DIR &= ~0x02 ;
```



## 1. LED

```c
#define LED1 P1_0
#define LED2 P1_1
#define LED3 P1_4
void main(void){
    LED1 = 1 ; // 配置高电平，消除电势差，灭灯
    LED1 = 0 ; // 配置低电平，产生电势差，点灯
    LED2 = 1 ; // 配置高电平，消除电势差，灭灯
    LED2 = 0 ; // 配置低电平，产生电势差，点灯
    LED3 = 1 ; // 配置高电平，消除电势差，灭灯
    LED3 = 0 ; // 配置低电平，产生电势差，点灯
}
```



### 1.1 LED1 

```c
#define LED1 P1_0   // LED1位于P1_0口
void InitLED(void){
    // 因为点灯时P1SEL和P1INP要设为默认值0，所以初始化时只初始化P1DIR即可
    P1DIR |= 0x01 ; // 定义P1_0为输出口 设为0x00为输入方向
    P1SEL = 0x00 ;  // 设置端口功能为通用I/O功能 设为0x01为外设功能
    P1INP = 0x00 ;  // 设置端口的上拉/下拉电阻
}
```

### 1.2 LED2 

```c
#define LED2 P1_1   // LED2位于P1_1口
void InitLED(void){
    // 因为点灯时P1SEL和P1INP要设为默认值0，所以初始化时只初始化P1DIR即可
    P1DIR |= 0x02 ; // 定义P1_1为输出口 设为0x00为输入方向
    P1SEL = 0x00 ;  // 设置端口功能为通用I/O功能 设为0x02为外设功能
    P1INP = 0x00 ;  // 设置端口的上拉/下拉电阻 
}
```

### 1.3 LED3 

```c
#define LED3 P1_4   // LED3位于P1_4口
// P1_4口同时还兼有通信功能，烧程序用的仿真器就在P1_4上，要想观察LED3的效果，就要拔掉仿真器用usb供电
void InitLED(void){
    // 因为点灯时P1SEL和P1INP要设为默认值0，所以初始化时只初始化P1DIR即可
    P1DIR |= 0x10 ; // 定义P1_4为输出口 设为0x00为输入方向
    P1SEL = 0x00 ;  // 设置端口功能为通用I/O功能 设为0x10为外设功能
    P1INP = 0x00 ;  // 设置端口的上拉/下拉电阻 
}
```

### 1.4 同时初始化多个灯

```c
#define LED1 P1_0
#define LED2 P1_1
#define LED3 P1_4
void InitLED(void){
    // 因为点灯时P1SEL和P1INP要设为默认值0，所以初始化时只初始化P1DIR即可
    P1DIR |= 0x03 ; //LED1和LED2: 0000 0011 => 0x03
    // P1DIR |= 0x11 ; //LED1和LED3: 0001 0001 => 0x11
    // P1DIR |= 0x12 ; //LED2和LED3: 0001 0010 => 0x12
    // P1DIR |= 0x13 ; //LED1、LED2和LED3: 0001 0011 => 0x13
    
    P1SEL = 0x00 ;  // 设置端口功能为外设功能 设为0x02为外设功能
    P1INP = 0x00 ;  // 设置端口的上拉/下拉电阻 
}
```

## 2. key

```c
#define KEY2 P2_0
// 在程序中按下按键会导通线路,出现电流,此时为1;不按下时为断路,无电流,此时为0
uchar KeyScan(void){
	// 简单的按键检测函数
	if (KEY1 == 0){
		DelayMS(10);  // 自己定义的延时函数，随便一个循环计数，达到计时目的即可
		if (KEY1 == 0){
			while(!KEY1);
			return 1 ;
		}
	}
}
```

### 2.1 key1

```c
#define KEY1 P0_1
void InitKey(void){
    P0SEL &= ~0x02 ; // 配置端口功能为通用I/O功能 设为0x10为外设功能
    P0DIR &= ~0x02 ; // 定义P0_1为输入口 设为0x02为输出端口
    P0INP &= ~0x02 ; // 设置端口的上拉/下拉电阻
}
```

### 2.2 key2

```c
#define KEY2 P2_0
void InitKey(void){
	P2SEL &= ~0x01 ; // 配置端口功能为通用I/O功能 设为0x01为外设功能
	P2DIR &= ~0x01 ; // 定义P2_0为输入口 设为0x01为输出端口
	P2INP &= ~0x01 ; // 设置端口的上拉/下拉电阻
}
```

### 2.3 key1的中断

```c
#define KEY1 P0_1

void InitKey(void){
    // 初始化按键及中断配置
    P0IEN |= 0x02 ; // 启用P0号端口第二位的中断功能 0000 0010 ;设为0禁用中断
    PICTL |= 0x01 ; // 设置触发方式,设1为沿下降沿触发(松手时触发);设为0为沿上升沿触发(按下时触发);此寄存器的前四位为控制端口中断触发方式: 第1位控制P0_1~P0_7的触发方式;第二位控制P1_0~P1_3的触发方式;第三位控制P1_4~P1_7的触发方式,第四位控制P2_0~P2_4的触发方式
    INE1 |= 0x02 ;  // 允许P0端口中断
    // P0IE = 1 ;     // 与上一行同作用,二者选一
    P0IFG = 0x00 ;  // 初始化中断标志位
    EA = 1 ;        // 打开总中断开关
}
#pragma vector = P0INT_VECTOR // 配置中断中断向量
__interrupt void P0_ISR(void){
    // 中断服务函数,为中断触发时具体功能执行函数
    /*
    	此处为函数功能
    */
    P0IFG = 0 ; // 清除中断标志
    // P0IF = 0 ;  // 清除中断标志,与上一行同作用,二者选一
}
```

### 2.4 key2的中断

```c
#define KEY2 P2_0

void InitKey(void){
    P2IEN |= 0x01 ; // 启用P2号端口第一位的中断功能 0000 0001 ;设为0禁用中断
    PICTL |= 0x08 ; // 设置触发方式,设1为沿下降沿触发;设为0为沿上升沿触发
    INE2  |= 0x02 ; // 允许P2端口中断
    // P2IE = 1 //与上一行同作用,二者选一
    P2IFG = 0x00 ;  // 初始化中断标志位
    EA = 1;         // 打开总中断
}
#pragma vector = P2INT_vector
__interrupt void P0_ISR(void){
    //中断服务函数,为中断触发时具体功能执行函数
    /*
    	此处为函数功能
    */
    P2IFG = 0 ; //清除中断标志
    // P2IF = 0 ;  //清除中断标志,与上一行同作用,二者选一
}
```





---

# to be continuintg......